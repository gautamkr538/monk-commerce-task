{
  "info": {
    "_postman_id": "9d6c44fa-6f69-4794-8a46-ecf5581469b9",
    "name": "Monk Commerce - Complete System with All Fields",
    "description": "Complete collection testing priority, usage limits, excluded products, and all features",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "40014525",
    "_collection_link": "https://rocketchat-2831.postman.co/workspace/Rocket.Chat-Workspace~6fab7108-4b0f-4995-8681-412e9958802c/collection/40014525-9d6c44fa-6f69-4794-8a46-ecf5581469b9?action=share&source=collection_link&creator=40014525"
  },
  "item": [
    {
      "name": "1. Basic Coupons",
      "item": [
        {
          "name": "1.1 Cart-Wise - Basic (No Limits)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    pm.collectionVariables.set('basicCartWiseCouponId', pm.response.json().id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"cart-wise\",\n  \"description\": \"Basic: 10% off on orders above ₹1000\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"details\": {\n    \"threshold\": 1000,\n    \"discount\": 10,\n    \"max_discount\": 200\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        },
        {
          "name": "1.2 Product-Wise - Basic (No Limits)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    pm.collectionVariables.set('basicProductWiseCouponId', pm.response.json().id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"product-wise\",\n  \"description\": \"Basic: 15% off on Product 1001\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"details\": {\n    \"product_id\": 1001,\n    \"discount\": 15\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        },
        {
          "name": "1.3 BxGy - Simple (No Tiers)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    pm.collectionVariables.set('basicBxGyCouponId', pm.response.json().id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"bxgy\",\n  \"description\": \"Buy 2 of Product 2001, Get 1 Product 2002 Free\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"details\": {\n    \"buy_products\": [\n      {\"product_id\": 2001, \"quantity\": 2}\n    ],\n    \"get_products\": [\n      {\"product_id\": 2002, \"quantity\": 1}\n    ],\n    \"repition_limit\": 3\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "2. Usage Limits",
      "item": [
        {
          "name": "2.1 Create Flash Sale (100 total, 1 per user)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const res = pm.response.json();",
                  "    pm.collectionVariables.set('limitedCouponId', res.id);",
                  "    pm.test('Has max_usage_limit', () => pm.expect(res.max_usage_limit).to.equal(100));",
                  "    pm.test('Has usage_limit_per_user', () => pm.expect(res.usage_limit_per_user).to.equal(1));",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"cart-wise\",\n  \"description\": \"Flash Sale: 20% off (100 uses, 1 per user)\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-10T23:59:59\",\n  \"max_usage_limit\": 100,\n  \"usage_limit_per_user\": 1,\n  \"details\": {\n    \"threshold\": 500,\n    \"discount\": 20,\n    \"max_discount\": 500\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        },
        {
          "name": "2.2 User1 - First Use (Should Work)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 1001, \"quantity\": 2, \"price\": 600}\n    ],\n    \"user_id\": \"user001\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/apply-coupon/{{limitedCouponId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "apply-coupon",
                "{{limitedCouponId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "2.3 User1 - Second Use (Should Fail - Limit Reached)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 1001, \"quantity\": 2, \"price\": 600}\n    ],\n    \"user_id\": \"user001\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/apply-coupon/{{limitedCouponId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "apply-coupon",
                "{{limitedCouponId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "2.4 User2 - First Use (Should Work)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 1001, \"quantity\": 2, \"price\": 600}\n    ],\n    \"user_id\": \"user002\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/apply-coupon/{{limitedCouponId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "apply-coupon",
                "{{limitedCouponId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "2.5 Check Remaining Uses",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const coupons = pm.response.json().applicable_coupons;",
                  "const limited = coupons.find(c => c.coupon_id === pm.collectionVariables.get('limitedCouponId'));",
                  "if (limited) {",
                  "    pm.test('Has user_usage_remaining', () => pm.expect(limited.user_usage_remaining).to.exist);",
                  "    pm.test('Has global_usage_remaining', () => pm.expect(limited.global_usage_remaining).to.exist);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 1001, \"quantity\": 2, \"price\": 600}\n    ],\n    \"user_id\": \"user003\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/applicable-coupons",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "applicable-coupons"
              ]
            }
          },
          "response": []
        },
        {
          "name": "2.6 Create Unlimited Global, Limited Per User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"cart-wise\",\n  \"description\": \"Loyalty: Unlimited global, 5 per user\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"usage_limit_per_user\": 5,\n  \"details\": {\n    \"threshold\": 500,\n    \"discount\": 10,\n    \"max_discount\": 200\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "3. Priority System",
      "item": [
        {
          "name": "3.1 Create High Priority Coupon (Priority 10)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const res = pm.response.json();",
                  "    pm.collectionVariables.set('highPriorityCouponId', res.id);",
                  "    pm.test('Priority is 10', () => pm.expect(res.priority).to.equal(10));",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"cart-wise\",\n  \"description\": \"HIGH PRIORITY: 15% off above ₹1000\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"priority\": 10,\n  \"details\": {\n    \"threshold\": 1000,\n    \"discount\": 15,\n    \"max_discount\": 300\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        },
        {
          "name": "3.2 Create Medium Priority Coupon (Priority 5)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    pm.collectionVariables.set('lowPriorityCouponId', pm.response.json().id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"product-wise\",\n  \"description\": \"MEDIUM PRIORITY: 10% off Product 1001\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"priority\": 5,\n  \"details\": {\n    \"product_id\": 1001,\n    \"discount\": 10\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        },
        {
          "name": "3.3 Create Low Priority Coupon (Priority 1)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"cart-wise\",\n  \"description\": \"LOW PRIORITY: 5% off above ₹500\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"priority\": 1,\n  \"details\": {\n    \"threshold\": 500,\n    \"discount\": 5,\n    \"max_discount\": 100\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        },
        {
          "name": "3.4 Check Priority Order",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const coupons = pm.response.json().applicable_coupons;",
                  "pm.test('Coupons sorted by priority', () => {",
                  "    if (coupons.length > 1) {",
                  "        for (let i = 0; i < coupons.length - 1; i++) {",
                  "            pm.expect(coupons[i].priority).to.be.at.least(coupons[i+1].priority);",
                  "        }",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 1001, \"quantity\": 3, \"price\": 500},\n      {\"product_id\": 1002, \"quantity\": 1, \"price\": 300}\n    ],\n    \"user_id\": \"user123\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/applicable-coupons",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "applicable-coupons"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "4. Stacking",
      "item": [
        {
          "name": "4.1 Create Stackable Coupon 1",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const res = pm.response.json();",
                  "    pm.collectionVariables.set('stackableCoupon1Id', res.id);",
                  "    pm.test('Stacking allowed', () => pm.expect(res.allow_stacking).to.be.true);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"cart-wise\",\n  \"description\": \"Stackable 1: 10% off above ₹1000\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"allow_stacking\": true,\n  \"priority\": 10,\n  \"details\": {\n    \"threshold\": 1000,\n    \"discount\": 10,\n    \"max_discount\": 200\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        },
        {
          "name": "4.2 Create Stackable Coupon 2",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    pm.collectionVariables.set('stackableCoupon2Id', pm.response.json().id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"product-wise\",\n  \"description\": \"Stackable 2: 5% off Product 1001\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"allow_stacking\": true,\n  \"priority\": 5,\n  \"details\": {\n    \"product_id\": 1001,\n    \"discount\": 5\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        },
        {
          "name": "4.3 Create Non-Stackable Coupon",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"cart-wise\",\n  \"description\": \"NON-STACKABLE: 25% off above ₹2000\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"allow_stacking\": false,\n  \"priority\": 8,\n  \"details\": {\n    \"threshold\": 2000,\n    \"discount\": 25,\n    \"max_discount\": 1000\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        },
        {
          "name": "4.4 Check Stackable Flag in Response",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const coupons = pm.response.json().applicable_coupons;",
                  "pm.test('Has is_stackable field', () => {",
                  "    coupons.forEach(c => pm.expect(c).to.have.property('is_stackable'));",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 1001, \"quantity\": 3, \"price\": 500},\n      {\"product_id\": 1002, \"quantity\": 2, \"price\": 400}\n    ],\n    \"user_id\": \"user123\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/applicable-coupons",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "applicable-coupons"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "5. Excluded Products",
      "item": [
        {
          "name": "5.1 Create with Excluded Products",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const res = pm.response.json();",
                  "    pm.collectionVariables.set('excludedCouponId', res.id);",
                  "    pm.test('Has excluded_products', () => {",
                  "        pm.expect(res.excluded_products).to.be.an('array');",
                  "        pm.expect(res.excluded_products).to.include(1001);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"cart-wise\",\n  \"description\": \"20% off (excluding Apple products: 1001, 1002, 1003)\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"details\": {\n    \"threshold\": 1000,\n    \"discount\": 20,\n    \"max_discount\": 500\n  },\n  \"excluded_products\": [1001, 1002, 1003]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        },
        {
          "name": "5.2 Cart WITHOUT Excluded (Should Apply)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 2001, \"quantity\": 2, \"price\": 600},\n      {\"product_id\": 2002, \"quantity\": 1, \"price\": 500}\n    ],\n    \"user_id\": \"user123\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/apply-coupon/{{excludedCouponId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "apply-coupon",
                "{{excludedCouponId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "5.3 Cart WITH Excluded (Should NOT Apply)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 1001, \"quantity\": 1, \"price\": 500},\n      {\"product_id\": 2001, \"quantity\": 2, \"price\": 600}\n    ],\n    \"user_id\": \"user123\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/apply-coupon/{{excludedCouponId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "apply-coupon",
                "{{excludedCouponId}}"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "6. Tiered BxGy",
      "item": [
        {
          "name": "6.1 Create 3-Tier BxGy",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    pm.collectionVariables.set('tieredBxgyCouponId', pm.response.json().id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"bxgy\",\n  \"description\": \"Tiered: Buy 2→Get 1 | Buy 4→Get 2 | Buy 6→Get 3\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"details\": {\n    \"buy_products\": [\n      {\"product_id\": 3001, \"quantity\": 2, \"tier_level\": 1},\n      {\"product_id\": 3001, \"quantity\": 4, \"tier_level\": 2},\n      {\"product_id\": 3001, \"quantity\": 6, \"tier_level\": 3}\n    ],\n    \"get_products\": [\n      {\"product_id\": 3002, \"quantity\": 1, \"tier_level\": 1},\n      {\"product_id\": 3002, \"quantity\": 2, \"tier_level\": 2},\n      {\"product_id\": 3002, \"quantity\": 3, \"tier_level\": 3}\n    ],\n    \"repition_limit\": 2\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        },
        {
          "name": "6.2 Test Tier 1",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 3001, \"quantity\": 2, \"price\": 300},\n      {\"product_id\": 3002, \"quantity\": 2, \"price\": 250}\n    ],\n    \"user_id\": \"user123\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/apply-coupon/{{tieredBxgyCouponId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "apply-coupon",
                "{{tieredBxgyCouponId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "6.3 Test Tier 2",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 3001, \"quantity\": 4, \"price\": 300},\n      {\"product_id\": 3002, \"quantity\": 3, \"price\": 250}\n    ],\n    \"user_id\": \"user123\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/apply-coupon/{{tieredBxgyCouponId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "apply-coupon",
                "{{tieredBxgyCouponId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "6.4 Test Tier 3",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 3001, \"quantity\": 7, \"price\": 300},\n      {\"product_id\": 3002, \"quantity\": 5, \"price\": 250}\n    ],\n    \"user_id\": \"user123\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/apply-coupon/{{tieredBxgyCouponId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "apply-coupon",
                "{{tieredBxgyCouponId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "6.5 Test Repetition Limit",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 3001, \"quantity\": 14, \"price\": 300},\n      {\"product_id\": 3002, \"quantity\": 10, \"price\": 250}\n    ],\n    \"user_id\": \"user123\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/apply-coupon/{{tieredBxgyCouponId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "apply-coupon",
                "{{tieredBxgyCouponId}}"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "7. Complete Feature Test",
      "item": [
        {
          "name": "7.1 Create Coupon with ALL Fields",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"cart-wise\",\n  \"description\": \"COMPLETE: All fields included\",\n  \"is_active\": true,\n  \"expiration_date\": \"2025-12-31T23:59:59\",\n  \"max_usage_limit\": 500,\n  \"usage_limit_per_user\": 3,\n  \"allow_stacking\": true,\n  \"priority\": 8,\n  \"details\": {\n    \"threshold\": 1500,\n    \"discount\": 18,\n    \"max_discount\": 400\n  },\n  \"excluded_products\": [9001, 9002, 9003]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/create",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "create"
              ]
            }
          },
          "response": []
        },
        {
          "name": "7.2 Get All Coupons",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/coupons/available",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "available"
              ]
            }
          },
          "response": []
        },
        {
          "name": "7.3 Get Applicable Coupons - Check All Fields",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const coupons = pm.response.json().applicable_coupons;",
                  "pm.test('All coupons have required fields', () => {",
                  "    coupons.forEach(c => {",
                  "        pm.expect(c).to.have.property('coupon_id');",
                  "        pm.expect(c).to.have.property('type');",
                  "        pm.expect(c).to.have.property('discount');",
                  "        pm.expect(c).to.have.property('is_stackable');",
                  "        pm.expect(c).to.have.property('priority');",
                  "    });",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cart\": {\n    \"items\": [\n      {\"product_id\": 1001, \"quantity\": 3, \"price\": 600},\n      {\"product_id\": 2001, \"quantity\": 2, \"price\": 400}\n    ],\n    \"user_id\": \"user999\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/cart/applicable-coupons",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "cart",
                "applicable-coupons"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "8. Update & Delete",
      "item": [
        {
          "name": "8.1 Update - Change Priority",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"cart-wise\",\n  \"description\": \"Updated: Priority changed to 15\",\n  \"priority\": 15,\n  \"details\": {\n    \"threshold\": 1000,\n    \"discount\": 10,\n    \"max_discount\": 200\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/{{basicCartWiseCouponId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "{{basicCartWiseCouponId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "8.2 Update - Add Usage Limits",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"product-wise\",\n  \"description\": \"Updated: Now with limits\",\n  \"max_usage_limit\": 200,\n  \"usage_limit_per_user\": 2,\n  \"details\": {\n    \"product_id\": 1001,\n    \"discount\": 15\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/coupons/{{basicProductWiseCouponId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "{{basicProductWiseCouponId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "8.3 Soft Delete",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/coupons/{{basicCartWiseCouponId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "coupons",
                "{{basicCartWiseCouponId}}"
              ]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080/monk/api/v1"
    },
    {
      "key": "basicCartWiseCouponId",
      "value": ""
    },
    {
      "key": "basicProductWiseCouponId",
      "value": ""
    },
    {
      "key": "basicBxGyCouponId",
      "value": ""
    },
    {
      "key": "tieredBxGyCouponId",
      "value": ""
    },
    {
      "key": "limitedCouponId",
      "value": ""
    },
    {
      "key": "excludedCouponId",
      "value": ""
    },
    {
      "key": "highPriorityCouponId",
      "value": ""
    },
    {
      "key": "lowPriorityCouponId",
      "value": ""
    },
    {
      "key": "stackableCoupon1Id",
      "value": ""
    },
    {
      "key": "stackableCoupon2Id",
      "value": ""
    },
    {
      "key": "tieredBxgyCouponId",
      "value": ""
    }
  ]
}